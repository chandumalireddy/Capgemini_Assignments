package com.casestudy;

import java.time.LocalDate;
import java.util.List;



import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.format.annotation.DateTimeFormat;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;




@RestController
@ResponseBody
@RequestMapping("/user")
public class controller {

	@Autowired
	userService s;
	

	
	@RequestMapping("/gettrain")
	public Train[] getalltrains()
	{
		RestTemplate resttemplate= new RestTemplate();
		
		Train[] m=resttemplate.getForObject("http://localhost:8082/train/all", Train[].class);

	return m;
	}
	@GetMapping("/gettrainby/{id}")
	public Train[] gettrainbyid(@PathVariable("id")Long id)
	{
		RestTemplate resttemplate= new RestTemplate();
		
		Train[] m=resttemplate.getForObject("http://localhost:8082/train/id/"+id, Train[].class);

	return m;
	}
	@GetMapping("/gettrain/{name}")
	public Train[] gettrainbyname(@PathVariable("name")String name)
	{
		RestTemplate resttemplate= new RestTemplate();
		
		Train[] m=resttemplate.getForObject("http://localhost:8082/train/"+name, Train[].class);

	return m;
	}
	@GetMapping("/gettrainwith/{source}")
	public Train[] gettrainbysource(@PathVariable("source")String source)
	{
		RestTemplate resttemplate= new RestTemplate();
		
		Train[] m=resttemplate.getForObject("http://localhost:8082/train/train/"+source, Train[].class);

	return m;
	}
	@GetMapping("/gettrainby/{source}/{destination}")
	public Train[] gettrainbysourceanddestination(@PathVariable("source")String source,@PathVariable("destination")String destination)
	{
		RestTemplate resttemplate= new RestTemplate();
		
		Train[] m=resttemplate.getForObject("http://localhost:8082/train/train/"+source+"/"+destination, Train[].class);

	return m;
	}
	@GetMapping("/gettrainby/{source}/{destination}/{date}")
	public Train[] gettrainbysourceanddestinationwithdate(@PathVariable("source")String source,@PathVariable("destination")String destination
			,@PathVariable("date") @DateTimeFormat(iso = DateTimeFormat.ISO.DATE)LocalDate date)
	{
		RestTemplate resttemplate= new RestTemplate();
		
		Train[] m=resttemplate.getForObject("http://localhost:8082/train/train/"+source+"/"+destination+"/"+date, Train[].class);

	return m;
	}
	
	@GetMapping("/wtihdate/{name}/{date}")
	public Train[] gettrainwithdate(@PathVariable("name")String name,@PathVariable("date") @DateTimeFormat(iso = DateTimeFormat.ISO.DATE)LocalDate date)
	{
		RestTemplate resttemplate= new RestTemplate();
		
		Train[] m=resttemplate.getForObject("http://localhost:8082/train/withdate/"+name+"/"+date, Train[].class);

	return m;
	}
	
	
	@PostMapping("/add")
	public void addtrain(@RequestBody user t)
	{
		 s.create(t);
		
		
	}
}
