package com.casestudy;

import java.time.LocalDate;
import java.util.Date;
import java.util.List;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.format.annotation.DateTimeFormat;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;



@RestController
@RequestMapping("/train")
public class RsourceController {

	 Logger logger = LoggerFactory.getLogger(getClass());
	 
	@Autowired
	private trainService s;
	
	@PostMapping("/add")
	public Train addtrain(@RequestBody Train t)
	{
		return s.saveTrain(t);
		
		
	}
	@RequestMapping("/{name}")
	public List<Train> finddepartbyid1(@PathVariable("name")String name)
	{
		

		return s.finddepartmentById2(name);
	}
	@RequestMapping("/id/{id}")
	public List<Train> finddepartbyid4(@PathVariable("id") Long id)
	{
		

		return s.finddepartmentById5(id);
	}

	@GetMapping("/all")
	public List<Train> getalltraindetails()
	{
		return s.getallTrain();
	}
	@GetMapping("/train/{source}")
	public List<Train> getalltraindetailsfromsource(@PathVariable("source")String source)
	{
		return s.getallTrainsfromsource(source);
	}
	@GetMapping("/train/{source}/{destination}")
	public List<Train> getalltraindetailsfromsource(@PathVariable("source")String source,@PathVariable("destination")String destination)
	{
		return s.getallTrainsfromsourcetodestintion(source, destination);
	}
	
	@GetMapping("/train/{source}/{destination}/{date}")
	public List<Train> getalltraindetailsfromsourcewithdate(@PathVariable("source")String source,@PathVariable("destination")String destination,@PathVariable("date")  @DateTimeFormat(iso = DateTimeFormat.ISO.DATE)LocalDate date)
	{
		return s.getallTrainsfromsourcetodestintionwithdate(source, destination,date);
	}

	
	  @GetMapping("/withdate/{name}/{date}") public List<Train>
	  getalltraindetailswithdate(@PathVariable("name")String
	  name,@PathVariable("date") @DateTimeFormat(iso = DateTimeFormat.ISO.DATE)LocalDate date) {
		
		  return  s.getallTrainsfromsourcewithdate(name, date); 
	  
	  }
	  
	  
	  
	  
	  @PutMapping("/book/{name}/{date}/{type}") 
	  public void  book(@PathVariable("name")String name,@PathVariable("type")String  type,@PathVariable("date")@DateTimeFormat(iso = DateTimeFormat.ISO.DATE)LocalDate date) 
	  { 
		  List<Train>  t= s.getallTrainsfromsourcewithdate(name, date);
		  s.Book(t ,type);
	  
	  
	  
	  }
	  @PutMapping("/book/{name}/{date}/{type}/{seats}") 
	  public void  bookwithnumber(@PathVariable("name")String name,@PathVariable("type")String  type,@PathVariable("date")@DateTimeFormat(iso = DateTimeFormat.ISO.DATE)LocalDate date,@PathVariable("seats") int seats) 
	  { 
		  List<Train>  t= s.getallTrainsfromsourcewithdate(name, date);
		  s.Bookwithnum(t ,type,seats);
	  
	  
	  
	  }
	 
	 
	 
	
}
