package com.casestudy;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;



@Service
public class trainService {

	
	
	@Autowired
	trainRepo r;
	
	
	public Train saveTrain(Train d)
	{
		return r.save(d);
	}

	public List<Train> getallTrain(){
		List<Train> t=new ArrayList<>();
		r.findAll()
		.forEach(t::add);
		return t;
	
	}
	public List<Train> finddepartmentById2(String name) {
		
		
		List<Train> f=r.findBytrainname(name);
		
		return f;
		
	}
public List<Train> finddepartmentById5(Long id) {
		
		
		List<Train> f=r.findBytrainno(id);
		
		return f;
		
	}
	
	public void deletebyid(Long id) {
		
		r.deleteByTrainno(id);
	}
public void deletebydate(LocalDate date) {
		
		r.deleteBydate(date);
	}


	public List<Train> getallTrainsfromsource(String source) {
	
		List<Train> t=new ArrayList<>();
		r.findBysource(source)
		.forEach(t::add);
		return t;
		
	}
	
	public List<Train> getallTrainsfromsourcetodestintion(String source,String destination) {
		
		List<Train> t=new ArrayList<>();
		r.findBysource(source)
		.forEach(t::add);
		List<Train> q=new ArrayList<>();
		
		for(Train b:t)
		{
			if(b.getDestination().equals(destination))
			{
				q.add(b);
			}
		}
		
		
		return q;
		
	}
	
	
	
	
	
/*public Train Book(String name,String type,Train t) {
	int index=0;
	int c=0;
for(reservationType b:t.getReservationvacancy())
{
	if(b.getType().equals(type))
	{
		deletebyid(t.getTrainno());
		c=b.getReservations();
		--c;
		b.setReservations(c);
		r.save(t);
		
	}
	return t;}
*/

/*
 * public void Book(List<Train>h,String type) {
 * 
 * int c=0; for(Train b:h) { for(reservationType a: b.getReservationvacancy()) {
 * if(a.getType().equals(type)) { deletebyid(b.getTrainno());
 * c=a.getReservations(); --c; a.setReservations(c); r.save(b);
 * 
 * } }
 * 
 * 
 * } }
 */


  public void Book(List<Train>h,String type) {
  
  int c=0; for(Train b:h) { for(reservationType a: b.getReservationvacancy()) {
  if(a.getType().equals(type)) { deletebydate(b.getDate());
  c=a.getReservations(); --c; a.setReservations(c); r.save(b);
  
  } } }}
  
  public void Bookwithnum(List<Train>h,String type,int seats) {
	  
  int c=0; 
  for(Train b:h) 
  {
	  for(reservationType a: b.getReservationvacancy())
	  {
  if(a.getType().equals(type)) {
	  deletebydate(b.getDate());
  c=a.getReservations();
  c=c-seats;
  a.setReservations(c);
  r.save(b);
  
  } } }}
  
 


	public List<Train> getallTrainsfromsourcetodestintionwithdate(String source, String destination, LocalDate date) {
		
		List<Train> t=new ArrayList<>();
		r.findBysource(source)
		.forEach(t::add);
		List<Train> q=new ArrayList<>();
		
		for(Train b:t)
		{
			if(b.getDestination().equals(destination) && b.getDate().equals(date))
			{
				q.add(b);
			}
		}
		
		
		return q;
	}
	
	public List<Train> getallTrainsfromsourcewithdate(String name, LocalDate date) {
		
		
		List<Train> t=new ArrayList<>();
		r.findBytrainname(name)
		.forEach(t::add);
		List<Train> q=new ArrayList<>();
		
		for(Train b:t)
		{
			if(b.getDate().equals(date))
			{
				q.add(b);
			}
		}
		
return  q;
	}
	


}
